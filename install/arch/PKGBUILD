# Maintainer: Hongjie Zhai <zhaihj @ github>
pkgname='rock-git'
pkgver=0.1
pkgrel=1
pkgdesc="OOC compiler written in OOC"
arch=('i686' 'x86_64')
url="https://github.com/fasterthanlime/rock"
license=('MIT')
depends=('git' 'gc' 'pcre')
noextract=()
md5sums=() #generate with 'makepkg -g'

build() {
  cd "$srcdir"

  if [ -d rock ]; then
    cd rock
    git checkout master
    git pull
  else
    git clone git://github.com/fasterthanlime/rock rock
  fi
}

package() {
  cd "$srcdir/rock"
  make rescue
  install -d ${pkgdir}/usr/share/licenses/rock-git
  install $srcdir/rock-git/LICENSE ${pkgdir}/usr/share/licenses/rock-git/
  install -d ${pkgdir}/usr/bin
  install $srcdir/rock/bin/rock* ${pkgdir}/usr/bin/
  cp -rp $srcdir/rock/sdk ${pkgdir}/usr/sdk
  install -d ${pkgdir}/usr/local/man/man1
  install $srcdir/rock/docs/rock.1 ${pkgdir}/usr/local/man/man1/
}
